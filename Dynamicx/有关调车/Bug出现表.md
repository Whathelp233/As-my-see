# BUG 表（整合）

这里主要用来描述一些调车的时候可能出现的bug还有对应的解决方法

目录

[TOC]

## 系统

### NUC 14 PRO 掉网卡驱动 

带来的主要影响：连不上easywifi，不方便调车

主要解决方法：主要是上网去找对应的驱动，然后在本地编译后移到NUC的 /lib/firmware/ 目录下

一般来说队里的NUC是 intel的网卡，它的网卡驱动可以直接在官网上找到已经编译的版本

https://www.intel.cn/content/www/cn/zh/download/824804/intel-wireless-wi-fi-drivers-for-linux.html

（注意对应的内核版本）



### 在换完内核后，时间戳出现异常



------



## 硬件调试

### 在开启校准之后电机仍然无法转动

前置知识：增量式编码器在初始位置时会产生随机地址值，需要设置一个固定的限位(通过开启校准控制器），使之撞击到该限位后进行调试再使用。

我们有一个校准控制器，当开启控制器后电机即会撞击一次，在此之间可能存在一些问题使电机无法转动

未显示校准，电机也未转动

- can掉线
- 未设置PID（P值太小或没定义P）
- 代码出现错误



当显示调试成功但电机未转动

- urdf中有一个指定元素firsthole(?)，当获取到的值小于该元素时才会判断成功，若该元素过小，会造成该问题

## 影响重复度（弹丸散布）的因素

### 1. 非控制部分

1. 摩擦轮磨损

- 这个会导致射速波动变大，因为磨损程度不同必然导致初速度波动变大

2. 摩擦轮电机

- 确保电机完好，碰到过电机轴承有问题

3. 弹丸姿态

- 观察弹丸发射前的位置，保证每次的位置都相同
- 根据发射的情况（比如是否双发、卡弹），可以通过改变trigger的offset来解决；或者说一定要调一个合适的offset来使弹丸不双发、不卡弹

4. 弹丸粗糙程度

- 弹丸粗糙程度不同，也可能导致弹丸初速度不同，因为摩擦轮转速和弹丸的速度是符合动量守恒的

5. 单发限位

- 单发限位太软，限不住弹丸，会导致发射前弹丸的位置有问题，从而导致双发
- 单发限位太硬，会导致弹丸被单发限位卡住，导致卡弹
- 单发限位左右偏而非竖直，会导致弹丸发射之后左右偏

6. 底盘移动

- 每次发射的后座力可能会让底盘后移，导致弹丸发射的起点改变，进而导致重复度降低
- 其他原因导致的底盘移动都会导致重复度降低，要观察底盘确定他是否移动
- 底盘移动可以通过把底盘架起来解决，但是一定要架稳

7. 云台移动

- 英雄一定要标定imu，其他兵种可以不用
- imu一定要做好零飘补偿（method：IMU零飘补偿.md）
- 可以通过把底盘架起来，然后关掉orientation controller，这样用的就是底盘的数据，follow的时候底盘不会动，然后云台会follow过去；如果开了这个控制器，那就是用imu的数据，云台yaw动了之后，是底盘会follow过去

8. 撞枪管

- 对于17mm小弹丸，可以直接听声音判断
- 对于42mm大弹丸，个人认为：在测速内壁贴一圈复写纸+白纸为较好的方法

9. 温度

- 一定要**预热！！！**
- 空转温度上升幅度有限且速度较慢，可以套管发射，当射速波动大概稳定在一个值时，可以认为预热完成

10. **机械安装问题**

- **一定**要保证安装没有问题，精细到一个**垫片！！！**
- 确保**定心**没有问题

### 2. 控制部分

1. 调整拨盘offset来改变弹丸初始位置，要求调到他不卡弹、不双发
1. 调拨盘pid，使其不超调，不过阻尼
1. 摩擦轮掉速

- 个人测试：
  - 单个摩擦轮每次掉速波动大约在**30rad/s**
  - 每次发射两个摩擦轮掉速大约差**10rad/s**

3. 经验

- **影响上下散布**：射速波动
  - 弹丸新旧、摩擦轮温度、机械安装

- **影响左右散布**：弹丸定位
  - 单发限位是否晃动/歪、弹丸定心

<mark>机械的安装、环境（温度、湿度）、（弹丸的新旧），这是影响重复度最大的因素</mark>


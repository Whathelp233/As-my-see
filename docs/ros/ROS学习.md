# ROS#C++å­¦ä¹ 
> æ›´æ–°æ—¶é—´: 2026å¹´02æœˆ27æ—¥

# ç¼–å†™HW

> https://blog.csdn.net/AFATAR/article/details/107453318



# è‡ªæŸ¥

# ROS_INFO è°ƒè¯•æ—¶é—´æˆ³

> æŸ¥çœ‹logä¿¡æ¯ï¼š [rqt_console](https://blog.csdn.net/qq_30460905/article/details/123698106?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1-123698106-blog-108450089.pc_relevant_multi_platform_whitelistv1&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1-123698106-blog-108450089.pc_relevant_multi_platform_whitelistv1&utm_relevant_index=1) 
>
> è¿‡æ»¤logç­‰çº§ï¼š [rqt_logger_level]
>
> [å…¶ä»–](https://zhuanlan.zhihu.com/p/536485585)
>
> ROS_INFOå…·æœ‰æ—¶é—´æˆ³åŠŸèƒ½ï¼Œå…¶æ¬¡ï¼Œå®ƒæ€»å…±åŒ…å«äº”ä¸ªè®°å½•çº§åˆ«ï¼Œè¿™æ ·åšçš„ä¼˜ç‚¹æ˜¯å¯ä»¥ç¡®å®šåœ¨ä»»ä½•æ—¶é—´æœ‰é€‰æ‹©çš„æŸ¥çœ‹å„ç§ä¿¡æ¯ã€‚ æ¯”å¦‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨rqt_consoleæ£€è§†æ‰€æœ‰INFO

**æ‰“å°ä¸€æ¬¡ä¸å®šæ—¶æ‰“å°**

ROS_INFO_STREAM_ONCE    æ”¾åœ¨å›è°ƒå‡½æ•°ä¸­ç¡®è®¤æ•°æ®æœ‰æ¥æ”¶åˆ°ï¼Œä½†æ˜¯åˆä¸æƒ³ä¸€ç›´åˆ·å±å¯ä»¥ç”¨è¿™ä¸ª

ROS_INFO_STREAM_THROTTLE(0.5, "Message print every 0.5s");   å®šæ—¶åˆ·å±æœ‰æ—¶å€™å›è°ƒçš„é¢‘ç‡æ¯”è¾ƒé«˜ï¼Œå¯ä»¥è®¾ç½®æ…¢ä¸€ç‚¹çš„æ‰“å°

åœ¨rosç¨‹åºè¿è¡Œæ—¶ï¼Œé»˜è®¤æ˜¯ä¸æ˜¾ç¤ºdebugä¿¡æ¯çš„ã€‚å¦‚æœè¦æŸ¥çœ‹debugæ¶ˆæ¯ï¼Œéœ€è¦å…ˆè¿è¡Œrosrun rqt_logger_level rqt_logger_level



# ros::Time::now()

> è¯¥å‡½æ•°è¿”å›ç³»ç»Ÿæ—¶é—´æˆ–ä»¿çœŸæ—¶é—´
>
> **ros:time::now()è¾“å‡ºå€¼ä¸º0ï¼Ÿ**
>
> ROSè®¾ç½®äº†ä¸€ä¸ªæ¨¡æ‹Ÿæ—¶é’Ÿçš„èŠ‚ç‚¹ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ—¶é’Ÿçš„æ—¶å€™ï¼Œnow()è¿”å›æ—¶é—´0ç›´åˆ°ç¬¬ä¸€æ¡æ¶ˆæ¯åœ¨/clockå·²ç»æ”¶åˆ°ï¼Œæ‰€ä»¥å½“å®¢æˆ·ç«¯ä¸çŸ¥é“æ—¶é’Ÿæ—¶é—´æ—¶ros:time::now()è¾“å‡ºä¸º0ã€‚
>
>  
>
> **ros:time::now()è¾“å‡ºçš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ**
>
> ros:time::now()è¾“å‡ºçš„å€¼ä¸å‚æ•°use_sim_timeæœ‰å…³ã€‚
>
> use_sim_timeä¸ºtrueæ—¶ï¼Œros:time::now()è¾“å‡ºç³»ç»Ÿæ—¶é—´ï¼›
>
> use_sim_timeä¸ºfalseæ—¶ï¼Œros:time::now()è¾“å‡ºè¾“å‡ºä»¿çœŸæ—¶é—´ï¼Œå¦‚æœå›æ”¾bagåˆ™æ˜¯bagçš„æ—¶é—´ã€‚

**æ€ä¹ˆè®¾ç½®å‚æ•°use_sim_timeï¼Ÿ**

launchæ–‡ä»¶è®¾ç½®ï¼š

```
<param name="use_sim_time" value="false" />
```

é€šè¿‡èŠ‚ç‚¹è®¾ç½®:

```
rosparam set use_sim_time true
```

 

**å¦‚ä½•ç›´æ¥ä½¿ç”¨ç³»ç»Ÿæ—¶é—´ï¼Ÿ**

ä½¿ç”¨ ros::WallTime::now() 

æ’­æ”¾rosbagæ—¶ï¼Œè‹¥å‚æ•°/use_sim_time ä¸ºtrueï¼Œåˆ™æ­¤æ—¶

- ros::WallTime::now()ä¸ºå½“å‰çš„çœŸå®æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯å¢™ä¸Šçš„æŒ‚é’Ÿæ—¶é—´ï¼Œä¸€ç›´åœ¨èµ°ã€‚
- ros::Time::now()ä¸ºrosbagå½“æ—¶çš„æ—¶é—´ï¼Œæ˜¯ç”±bagä¸­/clockè·å–çš„ã€‚æ˜¯ä»¿çœŸæ—¶é—´ã€‚







# ros::Duration

> roslibç»™ç”¨æˆ·æä¾›äº†ros::Time and ros::Durationä¸¤ä¸ªç±»æ¥æè¿°æ—¶åˆ»ä»¥åŠæ—¶é—´é—´éš”ä¸¤ä¸ªæ¦‚å¿µï¼Œå…¶ä¸­Durationèƒ½å¤Ÿæ˜¯è´Ÿæ•°

# 2. æ—¶é—´ä¸æ—¶é—´é—´éš”çš„åŸºæœ¬ä½¿ç”¨



# 2.1 å¾—åˆ°å½“å‰æ—¶é—´

ros::Time begin = ros::Time::now();
 æ³¨ï¼šè‹¥æ˜¯ä½¿ç”¨çš„æ˜¯æ¨¡æ‹Ÿæ—¶é—´ï¼Œnowåœ¨/clockè¯é¢˜æ¥æ”¶åˆ°ç¬¬ä¸€ä¸ªæ¶ˆæ¯ä»¥å‰éƒ½ä¼šè¿”å›0ssr



#   2.2 å®šä¹‰ç±»å¯¹è±¡

ros::Time::Time(uint32_t *_sec,* uint32_t *_nsec*)
 ros::Time::Time(double t)

ros::Duration::Duration(uint32_t *_sec,* uint32_t *_nsec*)
 ros::Duration::Duration(double t)

_secæ˜¯ç§’ï¼Œ_nsecæ˜¯çº³ç§’
 æ•…ros::Time a_little_after_the_beginning(0, 1000000);ç­‰ä»·äºros::Time a_little_after_the_beginning(0.001);



# 2.3 ç›¸äº’è½¬åŒ–ã€æ¯”è¾ƒ

Timeç»§æ‰¿è‡ª
 template<class T, class D>
 class ros::TimeBase< T, D >

Durationç»§æ‰¿è‡ª
 template<class T>
 class ros::DurationBase< T >

ä¸¤ä¸ªåŸºç±»éƒ½å®ç°äº†>ã€<ã€!=ç­‰æ¯”è¾ƒç¬¦ã€‚è€Œä¸”äºŒè€…éƒ½å®ç°äº†
 uint64_t    toNSec () const
 double    toSec () const
 å’±ä»¬èƒ½å¤Ÿç»è¿‡è¿™ä¸¤ä¸ªå‡½æ•°æ¥è¿›è¡ŒTimeå’ŒDurationçš„è½¬åŒ–



# 2.4 è¿ç®—ç¬¦

ä¸¤ä¸ªåŸºç±»éƒ½é‡è½½äº†+ã€-ã€+=ã€-=è¿ç®—ç¬¦ï¼š

1 hour + 1 hour = 2 hours (*duration + duration = duration*)

2 hours - 1 hour = 1 hour (*duration - duration = duration*)

Today + 1 day = tomorrow (*time + duration = time*)

Today - tomorrow = -1 day (*time - time = duration*)

Today + tomorrow = *error* (*time + time is undefined*)



# 3. å»¶æ—¶ä¸å¾ªç¯

```
bool ros::Duration::sleep()
ros::Duration(0.5).sleep(); // sleep for half a second
```



# 4. å®šæ—¶å™¨



# **ros::Timer**

é¦–å…ˆé¡»è¦è¯´æ˜çš„æ˜¯ï¼ŒROSå¹¶éå®æ—¶ç³»ç»Ÿï¼Œå› æ­¤å®šæ—¶å™¨å¹¶ä¸èƒ½ç¡®ä¿ç²¾è‚¯å®šæ—¶ã€‚ç²¾ç¡®çš„æ‰§è¡Œæ—¶é—´ä»¥åŠç†è®ºä¸Šåº”è¯¥æ‰§è¡Œçš„æ—¶é—´èƒ½å¤Ÿåœ¨å›è°ƒå‡½æ•°çš„ros::TimerEventç»“æ„ä¸­è·å¾—ã€‚

```c
ros::Timer ros::NodeHandle::createTimer(ros::Duration period, <callback>, bool oneshot = false);

 ros::Timer timer = n.createTimer(ros::Duration(0.1), timerCallback);//å®šæ—¶0.1s

 void timerCallback(const ros::TimerEvent& e);
```



å…¶ä¸­oneshotæ˜¯å®šä¹‰æ˜¯å¦åªå®šæ—¶ä¸€æ¬¡ï¼Œé»˜è®¤è¿ç»­å®šæ—¶ã€‚è¿™é‡Œä¹Ÿä¸å¿…å®šè¦å›è°ƒå‡½æ•°ï¼Œä¹Ÿèƒ½å¤Ÿä¼ å‡½æ•°å¯¹è±¡ç­‰ï¼Œè¿™é‡Œä¸ç»†è¿°ã€‚

å…¶ä¸­TimerEventç»“æ„ä½“å®šä¹‰ä»¥ä¸‹ï¼š

```c++
struct TimerEvent
{
  Time last_expected;                     ///< In a perfect world, this is when the last callback should have happened
  Time last_real;                         ///< When the last callback actually happened

  Time current_expected;                  ///< In a perfect world, this is when the current callback should be happening
  Time current_real;                      ///< This is when the current callback was actually called (Time::now() as of the beginning of the callback)

  struct
  {
    WallDuration last_duration;           ///< How long the last callback ran for, always in wall-clock time
  } profile;
};
```



# ros::Rate

```
ros::Rate r(10); // 10 hz
while (ros::ok())
{
//... do some work ...
    bool met = r.sleep();
}
```

å®ƒçš„åŠŸèƒ½å°±æ˜¯å…ˆè®¾å®šä¸€ä¸ªé¢‘ç‡ï¼Œè€Œåç»è¿‡ç¡çœ åº¦è¿‡ä¸€ä¸ªå¾ªç¯ä¸­å‰©ä¸‹çš„æ—¶é—´ï¼Œæ¥è¾¾åˆ°è¯¥è®¾å®šé¢‘ç‡ã€‚è‹¥æ˜¯å¯ä»¥è¾¾åˆ°è¯¥è®¾å®šé¢‘ç‡åˆ™è¿”å›trueï¼Œä¸èƒ½åˆ™è¿”å›falseã€‚

è®¡æ—¶çš„èµ·ç‚¹æ˜¯ä¸Šä¸€æ¬¡ç¡çœ çš„æ—¶é—´ã€æ„é€ å‡½æ•°è¢«è°ƒç”¨ã€æˆ–è€…è°ƒç”¨void ros::Rate::reset()å‡½æ•°é‡ç½®æ—¶é—´ã€‚

ç”±äºæ²¡æœ‰TimerEventï¼Œå› æ­¤ç›¸å¯¹äºTimerè€Œè¨€ï¼ŒRateçš„ç²¾ç¡®åº¦ä¼šæœ‰æ‰€é™ä½ã€‚







# é˜…è¯»å›¢é˜Ÿä»£ç 

# æ‰“å°ç±»åtypeid().name()

> æˆ‘ä»¬å¦‚æœæƒ³è¦åœ¨æ§åˆ¶å°è¾“å‡ºæŸä¸ªç±»çš„åå­—ï¼Œæˆ‘ä»¬åº”è¯¥ç”¨ä»€ä¹ˆå‘½ä»¤ï¼Ÿ

åœ¨rm_commonçš„serice_caller.hé‡Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€æ¡å‘½ä»¤

```
typeid(ServiceType).name()
```

[æ›´å¤š](https://www.bbsmax.com/A/kvJ3Xm7O5g/)

**t.name()**
è¿”å›ç±»å‹çš„C-styleå­—ç¬¦ä¸²ï¼Œç±»å‹åå­—ç”¨ç³»ç»Ÿç›¸å…³çš„æ–¹æ³•äº§ç”Ÿã€‚

ServiceTypeæ˜¯é€šè¿‡template <class ServiceType>è·å–çš„ç±»ï¼Œå¦‚æœè¿™æ˜¯ä¸ªæ´¾ç”Ÿç±»ï¼Œé‚£ä¹ˆ.name()å¹¶ä¸ä¼šæ‰“å°å‡ºåŸºç±»åï¼Œè€Œæ˜¯å½“å‰ç±»çš„åå­—





# å…³é”®è¯explicit

 åœ¨ä¸€äº›ç±»é‡Œé¢çš„æ„é€ å‡½æ•°ä¼šè§åˆ°explictï¼Œ**explicitå…³é”®å­—çš„ä½œç”¨å°±æ˜¯é˜²æ­¢ç±»æ„é€ å‡½æ•°çš„éšå¼è‡ªåŠ¨è½¬æ¢.**

```c++
CxString string2 = 10;    // CxStringæ˜¯ç±»åï¼Œå®šä¹‰ç±»çš„æ—¶å€™å…ˆéšå¼CxString a(10),å†string2=a
                          //åŠ äº†explictåï¼Œè¿™æ ·æ˜¯ä¸è¡Œçš„, å› ä¸ºexplicitå…³é”®å­—å–æ¶ˆäº†éšå¼è½¬æ¢  
```

 **explicitå…³é”®å­—åªå¯¹æœ‰ä¸€ä¸ªå‚æ•°çš„ç±»æ„é€ å‡½æ•°æœ‰æ•ˆ, å¦‚æœç±»æ„é€ å‡½æ•°å‚æ•°å¤§äºæˆ–ç­‰äºä¸¤ä¸ªæ—¶, æ˜¯ä¸ä¼šäº§ç”Ÿéšå¼è½¬æ¢çš„, æ‰€ä»¥explicitå…³é”®å­—ä¹Ÿå°±æ— æ•ˆäº†.**

```c++
    explicit CxString(int age, int size) 
```

**ä¹Ÿæœ‰ä¸€ä¸ªä¾‹å¤–, å°±æ˜¯å½“é™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°ä»¥å¤–çš„å…¶ä»–å‚æ•°éƒ½æœ‰é»˜è®¤å€¼çš„æ—¶å€™, explicitå…³é”®å­—ä¾ç„¶æœ‰æ•ˆ, æ­¤æ—¶, å½“è°ƒç”¨æ„é€ å‡½æ•°æ—¶åªä¼ å…¥ä¸€ä¸ªå‚æ•°, ç­‰æ•ˆäºåªæœ‰ä¸€ä¸ªå‚æ•°çš„ç±»æ„é€ å‡½æ•°**

```c++
    explicit CxString(int age, int size = 0)  
```





# æ¨¡æ¿ç±»std::map

> STLæ˜¯æ ‡å‡†C++ç³»ç»Ÿçš„ä¸€ç»„æ¨¡æ¿ç±»ï¼Œä½¿ç”¨STLæ¨¡æ¿ç±»æœ€å¤§çš„å¥½å¤„å°±æ˜¯åœ¨å„ç§C++ç¼–è¯‘å™¨ä¸Šéƒ½é€šç”¨ã€‚
>
>  åœ¨STLæ¨¡æ¿ç±»ä¸­ï¼Œç”¨äºçº¿æ€§æ•°æ®å­˜å‚¨ç®¡ç†çš„ç±»ä¸»è¦æœ‰vector, list, map ç­‰ç­‰ã€‚



ä½¿ç”¨mapå¯¹è±¡é¦–å…ˆè¦åŒ…æ‹¬å¤´æ–‡ä»¶,åŒ…å«è¯­å¥ä¸­å¿…é¡»åŠ å…¥å¦‚ä¸‹åŒ…å«å£°æ˜

```c++
#include <map>
std:map<int, CString> enumMap;
```

æ³¨æ„ï¼ŒSTLå¤´æ–‡ä»¶æ²¡æœ‰æ‰©å±•å.h

åŒ…æ‹¬å¤´æ–‡ä»¶åå°±å¯ä»¥å®šä¹‰å’Œä½¿ç”¨mapå¯¹è±¡äº†ï¼Œmapå¯¹è±¡æ˜¯æ¨¡æ¿ç±»ï¼Œéœ€è¦å…³é”®å­—å’Œå­˜å‚¨å¯¹è±¡ä¸¤ä¸ªæ¨¡æ¿å‚æ•°ï¼Œè¿™æ ·å°±å®šä¹‰äº†ä¸€ä¸ª**ç”¨intä½œä¸ºå…³é”®å­—æ£€ç´¢CStringæ¡ç›®**çš„mapå¯¹è±¡ï¼Œstdè¡¨ç¤ºå‘½åç©ºé—´ï¼Œmapå¯¹è±¡åœ¨stdåå­—ç©ºé—´ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œåœ¨è¿™é‡Œæˆ‘ä»ç„¶ä½¿ç”¨äº†CStringç±»ï¼Œå…¶å®åº”è¯¥ä½¿ç”¨æ ‡å‡†C++çš„std::stringç±»ï¼Œæˆ‘ä»¬å¯¹æ¨¡æ¿ç±»è¿›è¡Œä¸€ä¸‹ç±»å‹å®šä¹‰ï¼Œè¿™æ ·ç”¨çš„æ–¹ä¾¿ï¼Œå½“ç„¶ï¼Œä¸å®šä¹‰ä¹Ÿå¯ä»¥ï¼Œä»£ç å¦‚ä¸‹ï¼š

```c++
enumMap[1] = "One";
enumMap[2] = "Two";
//.....
enumMap[1] = "One Edit";
//æˆ–è€…insertæ–¹æ³•
enumMap.insert(make_pair(1,"One"));
 
//è¿”å›mapä¸­ç›®å‰å­˜å‚¨æ¡ç›®çš„æ€»æ•°ç”¨size()æ–¹æ³•ï¼š
int nSize = enumMap.size();
```





#  å»¶æ—¶å‡½æ•°

> https://wenku.baidu.com/view/e7967cf787254b35eefdc8d376eeaeaad1f316ef.html

linuxä¸­å¸¸ç”¨å»¶æ—¶å‡½æ•° sleepï¼Œusleepï¼Œ ndelayï¼Œ mdelay

```c
#include <unistd.h>
	sleep(s);     //ç§’å»¶æ—¶ï¼Œå»¶æ—¶æˆåŠŸè¿”å›0ï¼Œå¤±è´¥åˆ™è¿”å›å‰©ä½™ç§’æ•°
	usleep(us);     //å¾®ç§’å»¶æ—¶ï¼Œå»¶æ—¶æˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1ã€‚å‚æ•°éœ€è¦å°äº1000000
```

linuxå†…æ ¸å¸¸ç”¨å»¶æ—¶å‡½æ•°

```c
#include <linux/delay.h>
	ndelay(ns);	  //çº³ç§’å»¶æ—¶
	udelay(us);   //å¾®ç§’å»¶æ—¶
	mdelay(ms);   //æ¯«ç§’å»¶æ—¶
```





# å‡½æ•°å¯¹è±¡

> æ¨¡ä»¿å‡½æ•°åŠŸèƒ½çš„ç±»ï¼Œä½¿ç”¨åŠŸèƒ½æ¯”ä¸€èˆ¬å‡½æ•°æ›´å¼ºå¤§ï¼Œä½†æœ¬è´¨ä»æ˜¯ç±»ã€‚åœ¨ä½¿ç”¨å‡½æ•°æŒ‡é’ˆçš„åœºåˆä¸­ï¼Œå®ƒå°±æ— èƒ½ä¸ºåŠ›äº†ã€‚ä¾‹å¦‚ï¼Œä½ ä¸èƒ½å°†å‡½æ•°å¯¹è±¡ä¼ ç»™qsortå‡½æ•°ï¼å› ä¸ºå®ƒåªæ¥å—å‡½æ•°æŒ‡é’ˆã€‚
>
> C++å‡½æ•°å¯¹è±¡å®è´¨ä¸Šæ˜¯ä¸€ä¸ªå®ç°äº†[operator](https://so.csdn.net/so/search?q=operator&spm=1001.2101.3001.7020)()--æ‹¬å·æ“ä½œç¬¦--çš„ç±»

![img](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNzIwODA5Ni02NThlYWU2ZjMwMjU2N2EzLnBuZw?x-oss-process=image/format,png)





> æœ‰æºå¸¦é™„åŠ æ•°æ®çš„åŠŸèƒ½ï¼Œé€šè¿‡æ„é€ å‡½æ•°è·å¾—æŸä¸ªå€¼ï¼Œè€Œåœ¨é‡è½½()æ“ä½œç¬¦åèƒ½å¤Ÿå†è°ƒç”¨ `ç±»å()`æ¥ç¼–è¾‘é™„åŠ æ•°æ®

```c
class  less 
{
    public : 
    less(int  num) : n(num) {} 
    bool operator()(int  value) 
    {
        return  value  < n;
    } 
    private : 
    int n;
};

less isLess(10);  
cout << isLess(9) << " " << isLess(12); // è¾“å‡º 1 0 

åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/bandaoyu/article/details/106358830
```



ä¸è¿‡ï¼Œç°å®æ˜¯æ®‹é…·çš„ã€‚å‡½æ•°å¯¹è±¡è™½ç„¶èƒ½å¤Ÿä¿æœ‰å­˜æˆå‘˜å‡½æ•°æŒ‡é’ˆå’Œè°ƒç”¨ä¿¡æ¯ï¼Œä»¥å¤‡è±¡å‡½æ•°æŒ‡é’ˆä¸€æ ·è¢«è°ƒç”¨ï¼Œä½†æ˜¯ï¼Œå®ƒçš„èƒ½åŠ›æœ‰é™ï¼Œä¸€ä¸ªå‡½æ•°å¯¹è±¡å®šä¹‰ï¼Œæœ€å¤šåªèƒ½å®ç°ä¸€ä¸ªæŒ‡å®šå‚æ•°æ•°ç›®çš„æˆå‘˜å‡½æ•°æŒ‡é’ˆã€‚





# å‡½æ•°å®¹å™¨boost::function

> boost::functionæ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„â€œå®¹å™¨â€ï¼Œæ¦‚å¿µä¸Šåƒæ˜¯**C/C++ä¸­å‡½æ•°æŒ‡é’ˆç±»å‹çš„æ³›åŒ–**ï¼Œæ˜¯ä¸€ç§â€œæ™ºèƒ½å‡½æ•°æŒ‡é’ˆâ€ã€‚å®ƒä»¥å¯¹è±¡çš„å½¢å¼å°è£…äº†åŸå§‹çš„å‡½æ•°æŒ‡é’ˆæˆ–å‡½æ•°å¯¹è±¡ï¼Œèƒ½å¤Ÿå®¹çº³**ä»»æ„ç¬¦åˆå‡½æ•°ç­¾åçš„å¯è°ƒç”¨å¯¹è±¡**ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥è¢«ç”¨äºå›è°ƒæœºåˆ¶ï¼Œ==æš‚æ—¶ä¿ç®¡å‡½æ•°æˆ–å‡½æ•°å¯¹è±¡==ï¼Œä»»ä½•æ™®é€šå‡½æ•°ï¼Œæˆå‘˜å‡½æ•°ï¼Œå‡½æ•°å¯¹è±¡éƒ½å¯ä»¥å­˜å‚¨åœ¨functionå¯¹è±¡ä¸­ï¼Œç„¶ååœ¨ä»»ä½•éœ€è¦çš„æ—¶å€™è¢«è°ƒç”¨ã€‚

```c
boost::functionèƒ½å¤Ÿä»£æ›¿å‡½æ•°æŒ‡é’ˆï¼Œå¹¶ä¸”èƒ½èƒ½æ¥å—å‡½æ•°æˆ–å‡½æ•°å¯¹è±¡ï¼Œå¢åŠ äº†ç¨‹åºçš„çµæ´»æ€§ã€‚å½“ç„¶ï¼Œå¸¦æ¥å¥½å¤„çš„åŒæ—¶ï¼Œä¹Ÿå¿…ç„¶æœ‰å¼Šç«¯ã€‚boost::functionç›¸æ¯”å‡½æ•°æŒ‡é’ˆæ¥è¯´ä½“ç§¯ç¨å¤§ä¸€ç‚¹ï¼Œé€Ÿåº¦ä¸Šç¨æ…¢ä¸€ç‚¹ã€‚

åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/huangjh2017/article/details/71124827
```



**è°ƒç”¨æ–¹å¼**

```c
#include <boost/function.hpp>
```

| é¦–é€‰è¯­æ³•                                   | ä¾¿æºå¼è¯­æ³•                             |
| ------------------------------------------ | -------------------------------------- |
| `boost::function<float (int x, int y)> f;` | `boost::function2<float, int, int> f;` |

- floatæ˜¯è¿”å›å€¼ï¼Œæ‹¬å·å†…æ˜¯intå‚æ•°

- functionå¯ä»¥é…åˆbindä½¿ç”¨ï¼Œå­˜å‚¨bindè¡¨è¾¾å¼çš„ç»“æœï¼Œä½¿bindå¯ä»¥è¢«å¤šæ¬¡è°ƒç”¨





# å‚æ•°ç»‘å®šboost::bind

> boost::bindæ˜¯æ ‡å‡†åº“å‡½æ•°std::bind1stå’Œstd::bind2ndçš„ä¸€ç§æ³›åŒ–å½¢å¼ã€‚å…¶å¯ä»¥æ”¯æŒå‡½æ•°å¯¹è±¡ã€å‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€æˆå‘˜å‡½æ•°æŒ‡é’ˆï¼Œå¹¶ä¸”ç»‘å®šä»»æ„å‚æ•°åˆ°æŸä¸ªæŒ‡å®šå€¼ä¸Šæˆ–è€…å°†è¾“å…¥å‚æ•°ä¼ å…¥ä»»æ„ä½ç½®ã€‚
>
> https://blog.csdn.net/az44yao/article/details/103367514

**ç¬¬ 1ç§ç”¨æ³•**
 å‘åŸå§‹å‡½æ•° fun ç»‘å®šæ‰€æœ‰çš„å‚æ•°

```c
  boost::bind(&fun, 3, 4)   // bindçš„å®å‚è¡¨ä¾æ¬¡ä¸º: è¦ç»‘å®šçš„å‡½æ•°çš„åœ°å€, ç»‘å®šåˆ°funçš„ç¬¬ä¸€ä¸ªå‚æ•°å€¼, ç¬¬äºŒä¸ªå‚æ•°å€¼...
```



bind(f, 1, 2)ç­‰ä»·äºf(1, 2); bind(g, 1, 2, 3)ç­‰ä»·äºg(1, 2, 3);



**ç¬¬ 2ç§ç”¨æ³•**
 å‘åŸå§‹å‡½æ•° fun ç»‘å®šä¸€éƒ¨åˆ†å‚æ•°

```c
  boost::bind(&fun, 3, _1)  // bindçš„å®å‚è¡¨ä¾æ¬¡è¿˜æ˜¯: è¦ç»‘å®šçš„å‡½æ•°çš„åœ°å€, è¦ç»‘å®šåˆ°funçš„ç¬¬ä¸€ä¸ªå‚æ•°å€¼, ç„¶åæ³¨æ„
     // å› ä¸ºæˆ‘ä»¬ä¸æ‰“ç®—å‘funç»‘å®šç¬¬2ä¸ªå‚æ•°(å³æˆ‘ä»¬å¸Œæœ›åœ¨è°ƒç”¨è¿”å›çš„Functoræ—¶å†æŒ‡å®šè¿™ä¸ªå‚æ•°çš„å€¼)
     // æ‰€ä»¥è¿™é‡Œä½¿ç”¨ _1 æ¥å ä½. è¿™é‡Œçš„ _1 ä»£è¡¨è¯¥æ–°å‡½æ•°å¯¹è±¡è¢«è°ƒç”¨æ—¶. å®å‚è¡¨çš„ç¬¬1ä¸ªå‚æ•°.
     // åŒç†ä¸‹è¾¹è¿˜ä¼šç”¨åˆ° _2 _3 è¿™æ ·çš„å ä½ç¬¦. 
```

è¿™é‡Œåªä¸ºfunç»‘å®šäº†ç¬¬ä¸€ä¸ªå‚æ•°3. æ‰€ä»¥**åœ¨è°ƒç”¨bindè¿”å›çš„å‡½æ•°å¯¹è±¡æ—¶**. éœ€è¦:
  boost::bind(&fun, 3, _1)(4); //è¿™ä¸ª4 ä¼šä»£æ›¿ _1 å ä½ç¬¦.



bind(f, _1, 5)(x)ç­‰ä»·äºf(x, 5)ï¼Œå…¶ä¸­_1æ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œè¡¨ç¤ºç”¨ç¬¬ä¸€ä¸ªå‚æ•°æ¥æ›¿æ¢;

bind(f, _2, _1)(x, y)ç­‰ä»·äºf(y, x);

bind(g, _1, 9, _1)(x)ç­‰ä»·äºg(x, 9, x);

bind(g, _3, _3, _3)(x, y, z)ç­‰ä»·äºg(z, z, z);



**ç¬¬ 3ç§ç”¨æ³•**
 ä¸å‘ fun ç»‘å®šä»»ä½•å‚æ•°

```c
  boost::bind(&fun, _1, _2)  // _1 _2 éƒ½æ˜¯å ä½ç¬¦. ä¸Šè¾¹å·²ç»è¯´è¿‡äº†.
 æ‰€ä»¥å®ƒå°±æ˜¯å°†æ–°å‡½æ•°å¯¹è±¡åœ¨è°ƒç”¨æ—¶çš„å®å‚è¡¨çš„ç¬¬1ä¸ªå‚æ•°å’Œç¬¬2ä¸ªå‚æ•° ç»‘å®šåˆ°funå‡½æ•°. 
  boost::bind(&fun, _1, _2)(3, 4);  // 3å°†ä»£æ›¿_1å ä½ç¬¦, 4å°†ä»£æ›¿_2å ä½ç¬¦.

 è¾“å‡º 3, 4
```





# æ–‡ä»¶è¯»å–

# æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰

> é¦–å…ˆæˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“æ–‡ä»¶æè¿°ç¬¦æ˜¯ä»€ä¹ˆ
>
> [é“¾æ¥](https://blog.csdn.net/yushuaigee/article/details/107883964?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166375095716782388070889%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166375095716782388070889&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-107883964-null-null.142^v48^control,201^v3^control_2&utm_term=%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6&spm=1018.2226.3001.4187)

linuxçš„è¿›ç¨‹æ¯æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå†…æ ¸å°±ä¼šç»™è¿™ä¸ªæ–‡ä»¶ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ç”¨äºç´¢å¼•

è§„å®šç³»ç»Ÿåˆšåˆšå¯åŠ¨çš„æ—¶å€™ï¼Œ0æ˜¯æ ‡å‡†è¾“å…¥ï¼Œ1æ˜¯æ ‡å‡†è¾“å‡ºï¼Œ2æ˜¯æ ‡å‡†é”™è¯¯ã€‚è¿™æ„å‘³ç€å¦‚æœæ­¤æ—¶å»æ‰“å¼€ä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œå®ƒçš„æ–‡ä»¶æè¿°ç¬¦ä¼šæ˜¯3ï¼Œå†æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ–‡ä»¶æè¿°ç¬¦å°±æ˜¯4

![img](./ROS%E5%AD%A6%E4%B9%A0.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1c2h1YWlnZWU=,size_16,color_FFFFFF,t_70.png)





ä¾‹å¦‚åœ¨å›¢é˜Ÿgpio_manager.cppä»£ç 



```c
#include <fcntl.h>  //open()çš„å‡½æ•°åº“ï¼Œç”¨äºæ–‡ä»¶æ“ä½œ

std::string file = "/sys/class/gpio/gpio" + std::to_string(gpioData.pin) + "/direction";  //è®¾ç½®ä¸€ä¸ªæ–‡ä»¶çš„åœ°å€
  
  //å‚¨å­˜ç´¢å¼•çš„å˜é‡
  int fd;  
 
  //è°ƒç”¨<fcntl.h>çš„open()ï¼Œè¿”å›çš„æ˜¯æ–‡ä»¶æè¿°ç¬¦
  fd = open(file.data(), O_WRONLY);
```



fcntl.hçš„æ›´å¤šç”¨æ³• [é“¾æ¥](https://blog.csdn.net/qintaiwu/article/details/73438194)



# å‘æ–‡ä»¶å†™å…¥æ•°æ®

> å›¢é˜Ÿä½¿ç”¨unistd.hè¿›è¡Œå†™æ“ä½œ
>
> ç”¨æ³• [é“¾æ¥](https://blog.csdn.net/FML7169/article/details/101526754)



```c
 if (gpioData.type == rm_control::OUTPUT)
    {
      if (write(fd, "out", 3) != 3) //ä»¥æ–‡ä»¶æè¿°ç¬¦ä¸ºç´¢å¼•è¯»å–å†™å…¥ç›®æ ‡æ–‡ä»¶ï¼Œè¿”å›å†™å…¥çš„å­—èŠ‚æ•°
      {
        ROS_ERROR("[gpio]Failed to set direction of gpio%d", gpioData.pin);
      }
    }
```

---

## ğŸ“š æ‰©å±•é˜…è¯»

### å®˜æ–¹æ–‡æ¡£
- [ç›¸å…³å®˜æ–¹æ–‡æ¡£é“¾æ¥]()

### å­¦ä¹ èµ„æº
- [æ¨èæ•™ç¨‹]()
- [ç¤ºä¾‹ä»£ç ]()

### å¸¸è§é—®é¢˜
1. **é—®é¢˜æè¿°**
   è§£å†³æ–¹æ¡ˆ

## ğŸ› ï¸ å®è·µå»ºè®®

1. **å­¦ä¹ è·¯å¾„**
2. **å®è·µé¡¹ç›®**
3. **è°ƒè¯•æŠ€å·§**

> æœ€åæ›´æ–°: 2026-02-27 | ç”±OpenClawä¼˜åŒ–
